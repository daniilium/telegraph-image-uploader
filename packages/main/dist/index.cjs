"use strict";
const electron = require("electron");
const url = require("url");
const path = require("path");
const ALLOWED_ORIGINS_AND_PERMISSIONS = /* @__PURE__ */ new Map([[new url.URL("http://127.0.0.1:5173/").origin, /* @__PURE__ */ new Set()]]);
const ALLOWED_EXTERNAL_ORIGINS = /* @__PURE__ */ new Set(["https://github.com"]);
electron.app.on("web-contents-created", (_, contents) => {
  contents.on("will-navigate", (event, url$1) => {
    const { origin } = new url.URL(url$1);
    if (ALLOWED_ORIGINS_AND_PERMISSIONS.has(origin)) {
      return;
    }
    event.preventDefault();
    {
      console.warn(`Blocked navigating to disallowed origin: ${origin}`);
    }
  });
  contents.session.setPermissionRequestHandler((webContents, permission, callback) => {
    var _a;
    const { origin } = new url.URL(webContents.getURL());
    const permissionGranted = !!((_a = ALLOWED_ORIGINS_AND_PERMISSIONS.get(origin)) == null ? void 0 : _a.has(permission));
    callback(permissionGranted);
    if (!permissionGranted && true) {
      console.warn(`${origin} requested permission for '${permission}', but was rejected.`);
    }
  });
  contents.setWindowOpenHandler(({ url: url$1 }) => {
    const { origin } = new url.URL(url$1);
    if (ALLOWED_EXTERNAL_ORIGINS.has(origin)) {
      electron.shell.openExternal(url$1).catch(console.error);
    } else {
      console.warn(`Blocked the opening of a disallowed origin: ${origin}`);
    }
    return { action: "deny" };
  });
  contents.on("will-attach-webview", (event, webPreferences, params) => {
    const { origin } = new url.URL(params.src);
    if (!ALLOWED_ORIGINS_AND_PERMISSIONS.has(origin)) {
      {
        console.warn(`A webview tried to attach ${params.src}, but was blocked.`);
      }
      event.preventDefault();
      return;
    }
    delete webPreferences.preload;
    delete webPreferences.preloadURL;
    webPreferences.nodeIntegration = false;
    webPreferences.contextIsolation = true;
  });
});
async function createWindow() {
  const browserWindow = new electron.BrowserWindow({
    show: false,
    webPreferences: {
      nodeIntegration: false,
      contextIsolation: true,
      sandbox: false,
      webviewTag: false,
      preload: path.join(electron.app.getAppPath(), "packages/preload/dist/index.cjs")
    }
  });
  browserWindow.on("ready-to-show", () => {
    browserWindow == null ? void 0 : browserWindow.show();
    browserWindow.webContents.send("main-to-render", "value");
    {
      browserWindow == null ? void 0 : browserWindow.webContents.openDevTools();
    }
  });
  const pageUrl = "http://127.0.0.1:5173/";
  await browserWindow.loadURL(pageUrl);
  return browserWindow;
}
async function restoreOrCreateWindow() {
  let window = electron.BrowserWindow.getAllWindows().find((w) => !w.isDestroyed());
  if (window === void 0) {
    window = await createWindow();
  }
  if (window.isMinimized()) {
    window.restore();
  }
  window.focus();
}
const isSingleInstance = electron.app.requestSingleInstanceLock();
if (!isSingleInstance) {
  electron.app.quit();
  process.exit(0);
}
electron.app.on("second-instance", restoreOrCreateWindow);
electron.app.disableHardwareAcceleration();
electron.app.on("window-all-closed", () => {
  if (process.platform !== "darwin") {
    electron.app.quit();
  }
});
electron.app.on("activate", restoreOrCreateWindow);
electron.app.whenReady().then(restoreOrCreateWindow).catch((e) => console.error("Failed create window:", e));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguY2pzIiwic291cmNlcyI6WyIuLi9zcmMvc2VjdXJpdHktcmVzdHJpY3Rpb25zLnRzIiwiLi4vc3JjL21haW5XaW5kb3cudHMiLCIuLi9zcmMvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHthcHAsIHNoZWxsfSBmcm9tICdlbGVjdHJvbic7XG5pbXBvcnQge1VSTH0gZnJvbSAndXJsJztcblxudHlwZSBQZXJtaXNzaW9ucyA9XG4gIHwgJ2NsaXBib2FyZC1yZWFkJ1xuICB8ICdtZWRpYSdcbiAgfCAnZGlzcGxheS1jYXB0dXJlJ1xuICB8ICdtZWRpYUtleVN5c3RlbSdcbiAgfCAnZ2VvbG9jYXRpb24nXG4gIHwgJ25vdGlmaWNhdGlvbnMnXG4gIHwgJ21pZGknXG4gIHwgJ21pZGlTeXNleCdcbiAgfCAncG9pbnRlckxvY2snXG4gIHwgJ2Z1bGxzY3JlZW4nXG4gIHwgJ29wZW5FeHRlcm5hbCdcbiAgfCAndW5rbm93bic7XG5cbi8qKlxuICogQSBsaXN0IG9mIG9yaWdpbnMgdGhhdCB5b3UgYWxsb3cgb3BlbiBJTlNJREUgdGhlIGFwcGxpY2F0aW9uIGFuZCBwZXJtaXNzaW9ucyBmb3IgdGhlbS5cbiAqXG4gKiBJbiBkZXZlbG9wbWVudCBtb2RlIHlvdSBuZWVkIGFsbG93IG9wZW4gYFZJVEVfREVWX1NFUlZFUl9VUkxgLlxuICovXG5jb25zdCBBTExPV0VEX09SSUdJTlNfQU5EX1BFUk1JU1NJT05TID0gbmV3IE1hcDxzdHJpbmcsIFNldDxQZXJtaXNzaW9ucz4+KFxuICBpbXBvcnQubWV0YS5lbnYuREVWICYmIGltcG9ydC5tZXRhLmVudi5WSVRFX0RFVl9TRVJWRVJfVVJMXG4gICAgPyBbW25ldyBVUkwoaW1wb3J0Lm1ldGEuZW52LlZJVEVfREVWX1NFUlZFUl9VUkwpLm9yaWdpbiwgbmV3IFNldCgpXV1cbiAgICA6IFtdLFxuKTtcblxuLyoqXG4gKiBBIGxpc3Qgb2Ygb3JpZ2lucyB0aGF0IHlvdSBhbGxvdyBvcGVuIElOIEJST1dTRVIuXG4gKiBOYXZpZ2F0aW9uIHRvIHRoZSBvcmlnaW5zIGJlbG93IGlzIG9ubHkgcG9zc2libGUgaWYgdGhlIGxpbmsgb3BlbnMgaW4gYSBuZXcgd2luZG93LlxuICpcbiAqIEBleGFtcGxlXG4gKiA8YVxuICogICB0YXJnZXQ9XCJfYmxhbmtcIlxuICogICBocmVmPVwiaHR0cHM6Ly9naXRodWIuY29tL1wiXG4gKiA+XG4gKi9cbmNvbnN0IEFMTE9XRURfRVhURVJOQUxfT1JJR0lOUyA9IG5ldyBTZXQ8YGh0dHBzOi8vJHtzdHJpbmd9YD4oWydodHRwczovL2dpdGh1Yi5jb20nXSk7XG5cbmFwcC5vbignd2ViLWNvbnRlbnRzLWNyZWF0ZWQnLCAoXywgY29udGVudHMpID0+IHtcbiAgLyoqXG4gICAqIEJsb2NrIG5hdmlnYXRpb24gdG8gb3JpZ2lucyBub3Qgb24gdGhlIGFsbG93bGlzdC5cbiAgICpcbiAgICogTmF2aWdhdGlvbiBleHBsb2l0cyBhcmUgcXVpdGUgY29tbW9uLiBJZiBhbiBhdHRhY2tlciBjYW4gY29udmluY2UgdGhlIGFwcCB0byBuYXZpZ2F0ZSBhd2F5IGZyb20gaXRzIGN1cnJlbnQgcGFnZSxcbiAgICogdGhleSBjYW4gcG9zc2libHkgZm9yY2UgdGhlIGFwcCB0byBvcGVuIGFyYml0cmFyeSB3ZWIgcmVzb3VyY2VzL3dlYnNpdGVzIG9uIHRoZSB3ZWIuXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZWxlY3Ryb25qcy5vcmcvZG9jcy9sYXRlc3QvdHV0b3JpYWwvc2VjdXJpdHkjMTMtZGlzYWJsZS1vci1saW1pdC1uYXZpZ2F0aW9uXG4gICAqL1xuICBjb250ZW50cy5vbignd2lsbC1uYXZpZ2F0ZScsIChldmVudCwgdXJsKSA9PiB7XG4gICAgY29uc3Qge29yaWdpbn0gPSBuZXcgVVJMKHVybCk7XG4gICAgaWYgKEFMTE9XRURfT1JJR0lOU19BTkRfUEVSTUlTU0lPTlMuaGFzKG9yaWdpbikpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBQcmV2ZW50IG5hdmlnYXRpb25cbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgaWYgKGltcG9ydC5tZXRhLmVudi5ERVYpIHtcbiAgICAgIGNvbnNvbGUud2FybihgQmxvY2tlZCBuYXZpZ2F0aW5nIHRvIGRpc2FsbG93ZWQgb3JpZ2luOiAke29yaWdpbn1gKTtcbiAgICB9XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBCbG9jayByZXF1ZXN0cyBmb3IgZGlzYWxsb3dlZCBwZXJtaXNzaW9ucy5cbiAgICogQnkgZGVmYXVsdCwgRWxlY3Ryb24gd2lsbCBhdXRvbWF0aWNhbGx5IGFwcHJvdmUgYWxsIHBlcm1pc3Npb24gcmVxdWVzdHMuXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZWxlY3Ryb25qcy5vcmcvZG9jcy9sYXRlc3QvdHV0b3JpYWwvc2VjdXJpdHkjNS1oYW5kbGUtc2Vzc2lvbi1wZXJtaXNzaW9uLXJlcXVlc3RzLWZyb20tcmVtb3RlLWNvbnRlbnRcbiAgICovXG4gIGNvbnRlbnRzLnNlc3Npb24uc2V0UGVybWlzc2lvblJlcXVlc3RIYW5kbGVyKCh3ZWJDb250ZW50cywgcGVybWlzc2lvbiwgY2FsbGJhY2spID0+IHtcbiAgICBjb25zdCB7b3JpZ2lufSA9IG5ldyBVUkwod2ViQ29udGVudHMuZ2V0VVJMKCkpO1xuXG4gICAgY29uc3QgcGVybWlzc2lvbkdyYW50ZWQgPSAhIUFMTE9XRURfT1JJR0lOU19BTkRfUEVSTUlTU0lPTlMuZ2V0KG9yaWdpbik/LmhhcyhwZXJtaXNzaW9uKTtcbiAgICBjYWxsYmFjayhwZXJtaXNzaW9uR3JhbnRlZCk7XG5cbiAgICBpZiAoIXBlcm1pc3Npb25HcmFudGVkICYmIGltcG9ydC5tZXRhLmVudi5ERVYpIHtcbiAgICAgIGNvbnNvbGUud2FybihgJHtvcmlnaW59IHJlcXVlc3RlZCBwZXJtaXNzaW9uIGZvciAnJHtwZXJtaXNzaW9ufScsIGJ1dCB3YXMgcmVqZWN0ZWQuYCk7XG4gICAgfVxuICB9KTtcblxuICAvKipcbiAgICogSHlwZXJsaW5rcyBsZWFkaW5nIHRvIGFsbG93ZWQgc2l0ZXMgYXJlIG9wZW5lZCBpbiB0aGUgZGVmYXVsdCBicm93c2VyLlxuICAgKlxuICAgKiBUaGUgY3JlYXRpb24gb2YgbmV3IGB3ZWJDb250ZW50c2AgaXMgYSBjb21tb24gYXR0YWNrIHZlY3Rvci4gQXR0YWNrZXJzIGF0dGVtcHQgdG8gY29udmluY2UgdGhlIGFwcCB0byBjcmVhdGUgbmV3IHdpbmRvd3MsXG4gICAqIGZyYW1lcywgb3Igb3RoZXIgcmVuZGVyZXIgcHJvY2Vzc2VzIHdpdGggbW9yZSBwcml2aWxlZ2VzIHRoYW4gdGhleSBoYWQgYmVmb3JlOyBvciB3aXRoIHBhZ2VzIG9wZW5lZCB0aGF0IHRoZXkgY291bGRuJ3Qgb3BlbiBiZWZvcmUuXG4gICAqIFlvdSBzaG91bGQgZGVueSBhbnkgdW5leHBlY3RlZCB3aW5kb3cgY3JlYXRpb24uXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly93d3cuZWxlY3Ryb25qcy5vcmcvZG9jcy9sYXRlc3QvdHV0b3JpYWwvc2VjdXJpdHkjMTQtZGlzYWJsZS1vci1saW1pdC1jcmVhdGlvbi1vZi1uZXctd2luZG93c1xuICAgKiBAc2VlIGh0dHBzOi8vd3d3LmVsZWN0cm9uanMub3JnL2RvY3MvbGF0ZXN0L3R1dG9yaWFsL3NlY3VyaXR5IzE1LWRvLW5vdC11c2Utb3BlbmV4dGVybmFsLXdpdGgtdW50cnVzdGVkLWNvbnRlbnRcbiAgICovXG4gIGNvbnRlbnRzLnNldFdpbmRvd09wZW5IYW5kbGVyKCh7dXJsfSkgPT4ge1xuICAgIGNvbnN0IHtvcmlnaW59ID0gbmV3IFVSTCh1cmwpO1xuXG4gICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUeXBlIGNoZWNraW5nIGlzIHBlcmZvcm1lZCBpbiBydW50aW1lLlxuICAgIGlmIChBTExPV0VEX0VYVEVSTkFMX09SSUdJTlMuaGFzKG9yaWdpbikpIHtcbiAgICAgIC8vIE9wZW4gdXJsIGluIGRlZmF1bHQgYnJvd3Nlci5cbiAgICAgIHNoZWxsLm9wZW5FeHRlcm5hbCh1cmwpLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xuICAgIH0gZWxzZSBpZiAoaW1wb3J0Lm1ldGEuZW52LkRFVikge1xuICAgICAgY29uc29sZS53YXJuKGBCbG9ja2VkIHRoZSBvcGVuaW5nIG9mIGEgZGlzYWxsb3dlZCBvcmlnaW46ICR7b3JpZ2lufWApO1xuICAgIH1cblxuICAgIC8vIFByZXZlbnQgY3JlYXRpbmcgYSBuZXcgd2luZG93LlxuICAgIHJldHVybiB7YWN0aW9uOiAnZGVueSd9O1xuICB9KTtcblxuICAvKipcbiAgICogVmVyaWZ5IHdlYnZpZXcgb3B0aW9ucyBiZWZvcmUgY3JlYXRpb24uXG4gICAqXG4gICAqIFN0cmlwIGF3YXkgcHJlbG9hZCBzY3JpcHRzLCBkaXNhYmxlIE5vZGUuanMgaW50ZWdyYXRpb24sIGFuZCBlbnN1cmUgb3JpZ2lucyBhcmUgb24gdGhlIGFsbG93bGlzdC5cbiAgICpcbiAgICogQHNlZSBodHRwczovL3d3dy5lbGVjdHJvbmpzLm9yZy9kb2NzL2xhdGVzdC90dXRvcmlhbC9zZWN1cml0eSMxMi12ZXJpZnktd2Vidmlldy1vcHRpb25zLWJlZm9yZS1jcmVhdGlvblxuICAgKi9cbiAgY29udGVudHMub24oJ3dpbGwtYXR0YWNoLXdlYnZpZXcnLCAoZXZlbnQsIHdlYlByZWZlcmVuY2VzLCBwYXJhbXMpID0+IHtcbiAgICBjb25zdCB7b3JpZ2lufSA9IG5ldyBVUkwocGFyYW1zLnNyYyk7XG4gICAgaWYgKCFBTExPV0VEX09SSUdJTlNfQU5EX1BFUk1JU1NJT05TLmhhcyhvcmlnaW4pKSB7XG4gICAgICBpZiAoaW1wb3J0Lm1ldGEuZW52LkRFVikge1xuICAgICAgICBjb25zb2xlLndhcm4oYEEgd2VidmlldyB0cmllZCB0byBhdHRhY2ggJHtwYXJhbXMuc3JjfSwgYnV0IHdhcyBibG9ja2VkLmApO1xuICAgICAgfVxuXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFN0cmlwIGF3YXkgcHJlbG9hZCBzY3JpcHRzIGlmIHVudXNlZCBvciB2ZXJpZnkgdGhlaXIgbG9jYXRpb24gaXMgbGVnaXRpbWF0ZS5cbiAgICBkZWxldGUgd2ViUHJlZmVyZW5jZXMucHJlbG9hZDtcbiAgICAvLyBAdHMtZXhwZWN0LWVycm9yIGBwcmVsb2FkVVJMYCBleGlzdHMuIC0gQHNlZSBodHRwczovL3d3dy5lbGVjdHJvbmpzLm9yZy9kb2NzL2xhdGVzdC9hcGkvd2ViLWNvbnRlbnRzI2V2ZW50LXdpbGwtYXR0YWNoLXdlYnZpZXdcbiAgICBkZWxldGUgd2ViUHJlZmVyZW5jZXMucHJlbG9hZFVSTDtcblxuICAgIC8vIERpc2FibGUgTm9kZS5qcyBpbnRlZ3JhdGlvblxuICAgIHdlYlByZWZlcmVuY2VzLm5vZGVJbnRlZ3JhdGlvbiA9IGZhbHNlO1xuXG4gICAgLy8gRW5hYmxlIGNvbnRleHRJc29sYXRpb25cbiAgICB3ZWJQcmVmZXJlbmNlcy5jb250ZXh0SXNvbGF0aW9uID0gdHJ1ZTtcbiAgfSk7XG59KTtcbiIsImltcG9ydCB7IGFwcCwgQnJvd3NlcldpbmRvdyB9IGZyb20gXCJlbGVjdHJvblwiO1xuaW1wb3J0IHsgam9pbiB9IGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgeyBVUkwgfSBmcm9tIFwidXJsXCI7XG5pbXBvcnQgeyBnZXRBcHBGb2xkZXIgfSBmcm9tIFwiLi9nZXRBcHBGb2xkZXJcIjtcblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlV2luZG93KCkge1xuICBjb25zdCBicm93c2VyV2luZG93ID0gbmV3IEJyb3dzZXJXaW5kb3coe1xuICAgIHNob3c6IGZhbHNlLCAvLyBVc2UgdGhlICdyZWFkeS10by1zaG93JyBldmVudCB0byBzaG93IHRoZSBpbnN0YW50aWF0ZWQgQnJvd3NlcldpbmRvdy5cbiAgICB3ZWJQcmVmZXJlbmNlczoge1xuICAgICAgbm9kZUludGVncmF0aW9uOiBmYWxzZSxcbiAgICAgIGNvbnRleHRJc29sYXRpb246IHRydWUsXG4gICAgICBzYW5kYm94OiBmYWxzZSwgLy8gU2FuZGJveCBkaXNhYmxlZCBiZWNhdXNlIHRoZSBkZW1vIG9mIHByZWxvYWQgc2NyaXB0IGRlcGVuZCBvbiB0aGUgTm9kZS5qcyBhcGlcbiAgICAgIHdlYnZpZXdUYWc6IGZhbHNlLCAvLyBUaGUgd2VidmlldyB0YWcgaXMgbm90IHJlY29tbWVuZGVkLiBDb25zaWRlciBhbHRlcm5hdGl2ZXMgbGlrZSBhbiBpZnJhbWUgb3IgRWxlY3Ryb24ncyBCcm93c2VyVmlldy4gQHNlZSBodHRwczovL3d3dy5lbGVjdHJvbmpzLm9yZy9kb2NzL2xhdGVzdC9hcGkvd2Vidmlldy10YWcjd2FybmluZ1xuICAgICAgcHJlbG9hZDogam9pbihhcHAuZ2V0QXBwUGF0aCgpLCBcInBhY2thZ2VzL3ByZWxvYWQvZGlzdC9pbmRleC5janNcIiksXG4gICAgfSxcbiAgfSk7XG5cbiAgLyoqXG4gICAqIElmIHRoZSAnc2hvdycgcHJvcGVydHkgb2YgdGhlIEJyb3dzZXJXaW5kb3cncyBjb25zdHJ1Y3RvciBpcyBvbWl0dGVkIGZyb20gdGhlIGluaXRpYWxpemF0aW9uIG9wdGlvbnMsXG4gICAqIGl0IHRoZW4gZGVmYXVsdHMgdG8gJ3RydWUnLiBUaGlzIGNhbiBjYXVzZSBmbGlja2VyaW5nIGFzIHRoZSB3aW5kb3cgbG9hZHMgdGhlIGh0bWwgY29udGVudCxcbiAgICogYW5kIGl0IGFsc28gaGFzIHNob3cgcHJvYmxlbWF0aWMgYmVoYXZpb3VyIHdpdGggdGhlIGNsb3Npbmcgb2YgdGhlIHdpbmRvdy5cbiAgICogVXNlIGBzaG93OiBmYWxzZWAgYW5kIGxpc3RlbiB0byB0aGUgIGByZWFkeS10by1zaG93YCBldmVudCB0byBzaG93IHRoZSB3aW5kb3cuXG4gICAqXG4gICAqIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2VsZWN0cm9uL2VsZWN0cm9uL2lzc3Vlcy8yNTAxMiBmb3IgdGhlIGFmZm9yZCBtZW50aW9uZWQgaXNzdWUuXG4gICAqL1xuICBicm93c2VyV2luZG93Lm9uKFwicmVhZHktdG8tc2hvd1wiLCAoKSA9PiB7XG4gICAgYnJvd3NlcldpbmRvdz8uc2hvdygpO1xuXG4gICAgLy8gaXBjIGV2ZW50XG4gICAgYnJvd3NlcldpbmRvdy53ZWJDb250ZW50cy5zZW5kKFwibWFpbi10by1yZW5kZXJcIiwgXCJ2YWx1ZVwiKTtcblxuICAgIGlmIChpbXBvcnQubWV0YS5lbnYuREVWKSB7XG4gICAgICBicm93c2VyV2luZG93Py53ZWJDb250ZW50cy5vcGVuRGV2VG9vbHMoKTtcbiAgICB9XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBVUkwgZm9yIG1haW4gd2luZG93LlxuICAgKiBWaXRlIGRldiBzZXJ2ZXIgZm9yIGRldmVsb3BtZW50LlxuICAgKiBgZmlsZTovLy4uL3JlbmRlcmVyL2luZGV4Lmh0bWxgIGZvciBwcm9kdWN0aW9uIGFuZCB0ZXN0LlxuICAgKi9cbiAgY29uc3QgcGFnZVVybCA9XG4gICAgaW1wb3J0Lm1ldGEuZW52LkRFViAmJiBpbXBvcnQubWV0YS5lbnYuVklURV9ERVZfU0VSVkVSX1VSTCAhPT0gdW5kZWZpbmVkXG4gICAgICA/IGltcG9ydC5tZXRhLmVudi5WSVRFX0RFVl9TRVJWRVJfVVJMXG4gICAgICA6IG5ldyBVUkwoXG4gICAgICAgICAgXCIuLi9yZW5kZXJlci9kaXN0L2luZGV4Lmh0bWxcIixcbiAgICAgICAgICBcImZpbGU6Ly9cIiArIF9fZGlybmFtZVxuICAgICAgICApLnRvU3RyaW5nKCk7XG5cbiAgYXdhaXQgYnJvd3NlcldpbmRvdy5sb2FkVVJMKHBhZ2VVcmwpO1xuXG4gIHJldHVybiBicm93c2VyV2luZG93O1xufVxuXG4vKipcbiAqIFJlc3RvcmUgYW4gZXhpc3RpbmcgQnJvd3NlcldpbmRvdyBvciBDcmVhdGUgYSBuZXcgQnJvd3NlcldpbmRvdy5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlc3RvcmVPckNyZWF0ZVdpbmRvdygpIHtcbiAgbGV0IHdpbmRvdyA9IEJyb3dzZXJXaW5kb3cuZ2V0QWxsV2luZG93cygpLmZpbmQoKHcpID0+ICF3LmlzRGVzdHJveWVkKCkpO1xuXG4gIGlmICh3aW5kb3cgPT09IHVuZGVmaW5lZCkge1xuICAgIHdpbmRvdyA9IGF3YWl0IGNyZWF0ZVdpbmRvdygpO1xuICB9XG5cbiAgaWYgKHdpbmRvdy5pc01pbmltaXplZCgpKSB7XG4gICAgd2luZG93LnJlc3RvcmUoKTtcbiAgfVxuXG4gIHdpbmRvdy5mb2N1cygpO1xufVxuIiwiaW1wb3J0IHsgYXBwIH0gZnJvbSBcImVsZWN0cm9uXCI7XG5pbXBvcnQgXCIuL3NlY3VyaXR5LXJlc3RyaWN0aW9uc1wiO1xuaW1wb3J0IHsgcmVzdG9yZU9yQ3JlYXRlV2luZG93IH0gZnJvbSBcIi9AL21haW5XaW5kb3dcIjtcblxuLyoqXG4gKiBQcmV2ZW50IGVsZWN0cm9uIGZyb20gcnVubmluZyBtdWx0aXBsZSBpbnN0YW5jZXMuXG4gKi9cbmNvbnN0IGlzU2luZ2xlSW5zdGFuY2UgPSBhcHAucmVxdWVzdFNpbmdsZUluc3RhbmNlTG9jaygpO1xuaWYgKCFpc1NpbmdsZUluc3RhbmNlKSB7XG4gIGFwcC5xdWl0KCk7XG4gIHByb2Nlc3MuZXhpdCgwKTtcbn1cbmFwcC5vbihcInNlY29uZC1pbnN0YW5jZVwiLCByZXN0b3JlT3JDcmVhdGVXaW5kb3cpO1xuXG4vKipcbiAqIERpc2FibGUgSGFyZHdhcmUgQWNjZWxlcmF0aW9uIHRvIHNhdmUgbW9yZSBzeXN0ZW0gcmVzb3VyY2VzLlxuICovXG5hcHAuZGlzYWJsZUhhcmR3YXJlQWNjZWxlcmF0aW9uKCk7XG5cbi8qKlxuICogU2hvdXQgZG93biBiYWNrZ3JvdW5kIHByb2Nlc3MgaWYgYWxsIHdpbmRvd3Mgd2FzIGNsb3NlZFxuICovXG5hcHAub24oXCJ3aW5kb3ctYWxsLWNsb3NlZFwiLCAoKSA9PiB7XG4gIGlmIChwcm9jZXNzLnBsYXRmb3JtICE9PSBcImRhcndpblwiKSB7XG4gICAgYXBwLnF1aXQoKTtcbiAgfVxufSk7XG5cbi8qKlxuICogQHNlZSBodHRwczovL3d3dy5lbGVjdHJvbmpzLm9yZy9kb2NzL2xhdGVzdC9hcGkvYXBwI2V2ZW50LWFjdGl2YXRlLW1hY29zIEV2ZW50OiAnYWN0aXZhdGUnLlxuICovXG5hcHAub24oXCJhY3RpdmF0ZVwiLCByZXN0b3JlT3JDcmVhdGVXaW5kb3cpO1xuXG4vKipcbiAqIENyZWF0ZSB0aGUgYXBwbGljYXRpb24gd2luZG93IHdoZW4gdGhlIGJhY2tncm91bmQgcHJvY2VzcyBpcyByZWFkeS5cbiAqL1xuYXBwXG4gIC53aGVuUmVhZHkoKVxuICAudGhlbihyZXN0b3JlT3JDcmVhdGVXaW5kb3cpXG4gIC5jYXRjaCgoZSkgPT4gY29uc29sZS5lcnJvcihcIkZhaWxlZCBjcmVhdGUgd2luZG93OlwiLCBlKSk7XG5cbi8qKlxuICogQ2hlY2sgZm9yIG5ldyB2ZXJzaW9uIG9mIHRoZSBhcHBsaWNhdGlvbiAtIHByb2R1Y3Rpb24gbW9kZSBvbmx5LlxuICovXG5pZiAoaW1wb3J0Lm1ldGEuZW52LlBST0QpIHtcbiAgYXBwXG4gICAgLndoZW5SZWFkeSgpXG4gICAgLnRoZW4oKCkgPT4gaW1wb3J0KFwiZWxlY3Ryb24tdXBkYXRlclwiKSlcbiAgICAudGhlbigoeyBhdXRvVXBkYXRlciB9KSA9PiBhdXRvVXBkYXRlci5jaGVja0ZvclVwZGF0ZXNBbmROb3RpZnkoKSlcbiAgICAuY2F0Y2goKGUpID0+IGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgY2hlY2sgdXBkYXRlczpcIiwgZSkpO1xufVxuIl0sIm5hbWVzIjpbIlVSTCIsImFwcCIsInVybCIsInNoZWxsIiwiQnJvd3NlcldpbmRvdyIsImpvaW4iXSwibWFwcGluZ3MiOiI7Ozs7QUFzQkEsTUFBTSxrQ0FBa0Msb0JBQUksSUFFdEMsQ0FBQyxDQUFDLElBQUlBLElBQUFBLElBQUksd0JBQW1DLEVBQUUsUUFBUSxvQkFBSSxLQUFLLENBQUMsQ0FFdkU7QUFZQSxNQUFNLDJCQUEyQixvQkFBSSxJQUF5QixDQUFDLG9CQUFvQixDQUFDO0FBRXBGQyxTQUFBLElBQUksR0FBRyx3QkFBd0IsQ0FBQyxHQUFHLGFBQWE7QUFTOUMsV0FBUyxHQUFHLGlCQUFpQixDQUFDLE9BQU9DLFVBQVE7QUFD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
